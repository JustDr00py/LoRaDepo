# LoRaDB Docker Configuration Example
# Copy this file to .env and update with your values

# ============================================================================
# REQUIRED: Storage Configuration
# ============================================================================
LORADB_STORAGE_DATA_DIR=/var/lib/loradb/data

# ============================================================================
# REQUIRED: API Configuration
# ============================================================================
LORADB_API_BIND_ADDR=0.0.0.0:8443
LORADB_API_PORT=8443

# TLS Certificates (paths on host system - will be mounted into container)
LORADB_TLS_CERT_PATH=/path/to/your/cert.pem
LORADB_TLS_KEY_PATH=/path/to/your/key.pem

# Inside container, certificates will be at:
LORADB_API_TLS_CERT=/etc/loradb/cert.pem
LORADB_API_TLS_KEY=/etc/loradb/key.pem

# JWT Secret (minimum 32 characters - generate with: openssl rand -base64 32)
LORADB_API_JWT_SECRET=change-this-to-a-secure-32-character-secret-key!!!

# JWT token expiration in hours (default: 1)
# Note: For dashboard applications, consider using API tokens instead of JWT
LORADB_API_JWT_EXPIRATION_HOURS=1

# ============================================================================
# OPTIONAL: MQTT Configuration - ChirpStack
# ============================================================================
# LORADB_MQTT_CHIRPSTACK_BROKER=mqtts://chirpstack.example.com:8883
# LORADB_MQTT_USERNAME=loradb
# LORADB_MQTT_PASSWORD=your-mqtt-password

# ============================================================================
# OPTIONAL: MQTT Configuration - The Things Network
# ============================================================================
# LORADB_MQTT_TTN_BROKER=mqtts://nam1.cloud.thethings.network:8883

# ============================================================================
# OPTIONAL: Storage Tuning
# ============================================================================
# WAL sync interval in milliseconds (default: 1000)
LORADB_STORAGE_WAL_SYNC_INTERVAL_MS=1000

# Memtable size in MB before flush to SSTable (default: 64)
LORADB_STORAGE_MEMTABLE_SIZE_MB=64

# Periodic memtable flush interval in seconds (default: 300 = 5 minutes)
# Memtable will flush either when it reaches size threshold OR after this interval
LORADB_STORAGE_MEMTABLE_FLUSH_INTERVAL_SECS=300

# Number of SSTables before compaction (default: 10)
LORADB_STORAGE_COMPACTION_THRESHOLD=10

# Data retention policy (optional - commented out means keep data forever)
#
# GLOBAL DEFAULT: Applies to all applications without a specific policy
# Delete data older than X days (e.g., 30, 90, 365)
# LORADB_STORAGE_RETENTION_DAYS=90
#
# PER-APPLICATION POLICIES: Override global default for specific applications
# Format: "app-id-1:days,app-id-2:days,app-id-3:never"
# Use "never" to keep data forever for specific applications
# Examples:
#   Test data (7 days), production (1 year):
#   LORADB_STORAGE_RETENTION_APPS="test-sensors:7,production:365"
#
#   HVAC (1 year), occupancy (30 days for privacy), alarms (keep forever):
#   LORADB_STORAGE_RETENTION_APPS="hvac-sensors:365,occupancy:30,fire-alarms:never"
#
#   Multi-tenant with different tiers:
#   LORADB_STORAGE_RETENTION_APPS="customer-basic:30,customer-premium:730"
#
# LORADB_STORAGE_RETENTION_APPS="dev-app:7,test-app:14,staging:30"

# How often to check and enforce retention policy in hours (default: 24)
# Only applies if retention policy is configured
# LORADB_STORAGE_RETENTION_CHECK_INTERVAL_HOURS=24

# ============================================================================
# OPTIONAL: Encryption (AES-256-GCM)
# ============================================================================
# Enable encryption at rest (default: false)
# LORADB_STORAGE_ENABLE_ENCRYPTION=true

# Encryption key (base64-encoded 32-byte key - generate with: openssl rand -base64 32)
# LORADB_STORAGE_ENCRYPTION_KEY=your-base64-encoded-encryption-key-here

# ============================================================================
# OPTIONAL: API Tuning
# ============================================================================
# Rate limiting per minute (default: 100)
LORADB_API_RATE_LIMIT_PER_MINUTE=100

# CORS allowed origins (comma-separated list, default: "*" for development)
# Examples:
#   Development (allow all): *
#   Single origin: https://dashboard.example.com
#   Multiple origins: https://dashboard.example.com,https://admin.example.com
# IMPORTANT: Use specific origins in production for security
LORADB_API_CORS_ALLOWED_ORIGINS=*

# ============================================================================
# Docker-specific Configuration
# ============================================================================
# Rust logging level (info, debug, warn, error)
RUST_LOG=info,loradb=info

# Timezone (optional)
TZ=UTC
